<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Testing Async code</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="d94ccdc3-3182-4115-b129-47bde27206e0" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">🐎</span></div><h1 class="page-title">Testing Async code</h1></header><div class="page-body"><p id="2a2fa98f-400d-418c-be18-89f70b1414ae" class="">
</p><p id="bd5f3481-0d17-40d2-be8b-1d9ff1c39b7f" class="">
</p><figure id="617505ba-4a1b-48bd-a987-831af7991bc0"><a href="https://jestjs.io/docs/asynchronous" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Testing Asynchronous Code · Jest</div><div class="bookmark-description">It&#x27;s common in JavaScript for code to run asynchronously. When you have code that runs asynchronously, Jest needs to know when the code it is testing has completed, before it can move on to another test. Jest has several ways to handle this.</div></div><div class="bookmark-href"><img src="https://jestjs.io/img/favicon/favicon.ico" class="icon bookmark-icon"/>https://jestjs.io/docs/asynchronous</div></div><img src="https://jestjs.io/img/opengraph.png" class="bookmark-image"/></a></figure><p id="7ee3b76c-48f9-4c5c-be84-cd771cf72537" class="">
</p><nav id="e095fa32-0f26-4a31-acaf-ed82e525d386" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#e74a9e43-0bf9-4709-898e-15d951b47bce">Promise &amp; waitForElement</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#e20ed9e2-12bd-424d-ab44-b6561530096d">aync/await</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f7bba155-a306-484d-a812-c503d3be1c6d">Error handling </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#20a3b109-4680-46fc-bc41-b87085b676e4">An <code>async</code> function returns a Promise</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#f40c5c82-1bac-4c51-bcee-8641af100966">Test Plan Example</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#da15a724-5431-455b-985a-e49d2378ba74">Test Plan:</a></div></nav><p id="69b5174b-980c-4602-83d2-19ed60ab65d3" class="">
</p><figure id="b1970e2c-d9e7-467b-9635-3920d946d644" class="link-to-page"><a href="Mocking%20Modules%20&amp;%20Fixtures%20b1970e2cd9e7467b96353920d946d644.html"><span class="icon">👾</span>Mocking Modules &amp; Fixtures</a></figure><p id="1d32523e-51a6-4627-8ad3-91a380fd813a" class="">
</p><p id="cd85f9c0-edb5-4a83-9d70-c780d40eb0e7" class="">
</p><p id="9891e0a4-c8e7-45f2-8c04-2f5f815eae1b" class="">We can use mocking to replace the functionality of entire modules, 
even modules installed through npm. Mocks are a powerful feature of the 
Jest framework. They allow for flexibility in how we isolate parts of 
our code for testing. When we control the data used in the test 
environment, then we can predict the elements that will be rendered by 
the application.</p><p id="b3f45001-4508-4960-b8aa-79a2081fc91b" class="">We also covered how to wait for asynchronous changes in the interface
 and chain promises to allow for tests that resemble normal usage of our
 software.</p><p id="c860cd28-5d80-4fc5-860a-b4699b24edf0" class="">
</p><p id="ee617e0c-9ac9-4fa2-87ec-b7702912f662" class="">
</p><h1 id="e74a9e43-0bf9-4709-898e-15d951b47bce" class="">Promise &amp; waitForElement</h1><p id="e57de237-ea9b-4c65-8e90-db55185cba5c" class="">
</p><ul id="210e221c-d116-4159-8502-5986d1c7e9e3" class="bulleted-list"><li style="list-style-type:disc">waitforelement returns a promise from a truthy value returned by the callback within. After a time it rejects the Promise if nothing is returned.</li></ul><p id="0ce0022a-aca3-4d7a-ba94-fc72cc228fb5" class="">
</p><p id="e6515df6-72e6-40d2-aaa8-8f400ea6214b" class="">Start a promise chain with <code>waitForElement</code>
. The next 
operation in the promise chain should fire the click event on the 
&quot;Tuesday&quot; menu button and then verify that the text &quot;Leopold Silvers&quot; is
 in the document. </p><pre id="cc949dc0-bf9e-4d9c-be88-a6fe0fd24222" class="code"><code>it(&quot;defaults to Monday and changes the schedule when a new day is selected&quot;, () =&gt; {
  const { getByText } = render(&lt;Application /&gt;);

  return waitForElement(() =&gt; getByText(&quot;Monday&quot;)).then(() =&gt; {
    fireEvent.click(getByText(&quot;Tuesday&quot;));
    expect(getByText(&quot;Leopold Silvers&quot;)).toBeInTheDocument();
  });
});</code></pre><p id="ee2cafdb-a6c3-4fc5-b71f-63425fb22572" class="">
</p><p id="ff3546f5-1a26-4be1-a79f-9788ae304359" class="">
</p><h1 id="e20ed9e2-12bd-424d-ab44-b6561530096d" class="">aync/await</h1><p id="c3589a68-9502-4916-a1bf-cd3ea6b41142" class="">
</p><ul id="870df0a9-e8ed-4ad4-ab97-55286b9f0b27" class="bulleted-list"><li style="list-style-type:disc">does not replace Promises, just makes them easier to use</li></ul><ul id="12faf651-b596-4f15-b047-753b01749bc3" class="bulleted-list"><li style="list-style-type:disc">supported as of ECMAScript 2017</li></ul><p id="3f48a751-dade-4aa2-954b-14a1fdf28142" class="">
</p><pre id="ec3fc484-7ec9-4bfe-a537-08dfaaac826c" class="code"><code>it(&quot;changes the schedule when a new day is selected&quot;, () =&gt; {
  const { getByText } = render(&lt;Application /&gt;);

  return waitForElement(() =&gt; getByText(&quot;Monday&quot;)).then(() =&gt; {
    fireEvent.click(getByText(&quot;Tuesday&quot;));

    expect(getByText(&quot;Leopold Silvers&quot;)).toBeInTheDocument();
  });
});</code></pre><p id="25fdec77-f0cb-45fa-a964-2ca5febbc3a9" class="">BECOMES:</p><pre id="a65ffa01-9b04-430e-b190-af13bfb03df9" class="code"><code>it(&quot;changes the schedule when a new day is selected&quot;, async () =&gt; {
  const { getByText } = render(&lt;Application /&gt;);

  await waitForElement(() =&gt; getByText(&quot;Monday&quot;));

  fireEvent.click(getByText(&quot;Tuesday&quot;));

  expect(getByText(&quot;Leopold Silvers&quot;)).toBeInTheDocument();
});</code></pre><p id="cbc9fda5-d8a9-4f15-99dd-6bb69f85d10a" class="">The two primary changes are:</p><ol type="1" id="037f3416-7757-4bd3-80bc-7ea27b8a1c70" class="numbered-list" start="1"><li>The asynchronous function has been defined as one using the <code>async</code> keyword.</li></ol><ol type="1" id="f333b956-a44a-44b1-8878-1943d3be218c" class="numbered-list" start="2"><li>The Promise chain can be hidden by using the <code>await</code> keyword.</li></ol><p id="e5d5e031-7777-4c39-b789-5315aa03cb03" class="">
</p><p id="9f4cd62d-e263-4224-a307-81fe436013c7" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="075a5bc2-9413-496f-a989-f124d6a46b36"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">Important to note:

the use of <code>async</code> and <code>await</code>does not replace the use of Promises. They work well together. Promises represent a future value that is either resolved or rejected. Promises can be returned from functions, chained and passed to other functions.</div></figure><p id="ba814e48-92d4-4dc7-bd7c-3e04031d68c3" class="">
</p><p id="99e0c881-c94f-4a38-b147-dc613210b5a1" class="">Further:</p><pre id="ab244253-f9ee-4e9b-a583-abfe022eac52" class="code"><code>function setTimeoutPromise(error) {
  /* Wrapping a function that takes a callback with a Promise */
  return new Promise((resolve, reject) =&gt; {
    if (error) {
      /* When an error occurs we reject the Promise */
      reject(&quot;Error&quot;);
    } else {
      /* This Promise will resolve in 1000ms */
      setTimeout(() =&gt; resolve(&quot;Data&quot;), 1000);
    }
  });
}

setTimeoutPromise(true /* or false */)
  .then(data =&gt; {
    /* Success case */
    console.log(`Promise Resolved with ${data}`);
  })
  .catch(error =&gt; {
    /* Failure case */
    console.log(`Promise Rejected with ${error}`);
  });</code></pre><p id="0637f260-689f-4f24-9d8c-a3f03d79987b" class="">
</p><p id="e41bf5de-bbe6-436d-869e-c5d6bb27e0b6" class="">Any function that takes a callback can be wrapped in a Promise and included in a chain. Wrapping the <code>setTimeout</code>
 function in a Promise also makes it available to use with <code>async</code>
 and <code>await</code>
. The first thing we need to do is create an <code>async</code>
 function. We can invoke this function like any other function.</p><p id="ea05a4da-f3b6-4577-a7d1-e8a34a19e17a" class="">
</p><pre id="b50953d4-fcf2-4cd5-b7e4-abfb174b4021" class="code"><code>/* Can only use await inside of an async function */
async function run() {}

/* We can invoke the async function like any other */
run();</code></pre><p id="3c3c9a40-bec6-4aa2-9f3d-e1bfc0742b5d" class="">Now we can start using the <code>await</code> keyword. The only asynchronous operation we have is the delay. The Promise will resolve with some data. We need to capture that. With <code>await</code>
 the function will not run to completion until the Promise that we are awaiting has resolved.</p><pre id="d8bbb7f3-82fb-4fd5-bf0c-82ad9e52d119" class="code"><code>async function run() {
  /* We want to halt execution of this function until this Promise is resolved */
  const data = await setTimeoutPromise();

  /* The resolved behaves like a return value when we use await */
  console.log(`Promise Resolved with ${data}`);
}

run();</code></pre><p id="228a7c96-3cae-49b6-8128-28c6f5e849b7" class="">the resolved behaves like a return value when we use await</p><p id="5e4d5f4c-6d57-454b-ac8b-21591754d5fd" class="">
</p><h2 id="f7bba155-a306-484d-a812-c503d3be1c6d" class="">Error handling </h2><p id="a56353f2-6706-4eb8-a628-9cd8d092d308" class="">
</p><pre id="cf927058-a9c9-4e15-b1ee-038ab70548c9" class="code"><code>async function run() {
  console.log(&quot;1. The calm before async&quot;);

  try {
    const data = await setTimeoutPromise();

    console.log(`3. Promise Resolved with ${data}`);
  } catch (error) {
    /* A thrown error will be caught by the try/catch */
    console.log(`3. Promise Rejected with ${error}`);
  }
}

run();</code></pre><p id="048fd8c8-e295-400e-81f5-162ac9458c63" class="">try/catch has a similar structure to if/else</p><p id="58d048e1-9d58-4d51-a51f-76f977367e53" class="">
</p><p id="5bdee47f-5159-4e06-92b3-fbb5648c09d7" class="">
</p><h2 id="20a3b109-4680-46fc-bc41-b87085b676e4" class="">An <code>async</code> function returns a Promise</h2><pre id="4c817117-fcab-4988-be91-3196ec4f2a14" class="code code-wrap"><code>async function run() {
  console.log(&quot;1. The calm before async&quot;);

  try {
    const data = await setTimeoutPromise();

    console.log(`3. Promise Resolved with ${data}`);
  } catch (error) {
    console.log(`3. Promise Rejected with ${error}`);
  }
}

/* We can invoke the async function like any other */
run().then(() =&gt; {
  console.log(&quot;4. Use Pomises at the top level&quot;);
});

/* This prints immediately after run() is called */
console.log(&quot;2. Careful, this prints before the timeout is complete&quot;);

/*
1. The calm before async
2. Careful, this prints before completing the timeout
3. Promise Resolved with Resolved Data
4. Use Promises at the top level
*/
</code></pre><p id="4da6dedf-7793-4dab-8c2f-8e42800b2e9d" class="">
</p><p id="f73b1a2d-7b02-4d12-892e-3ed61813ec36" class="">
</p><p id="53f884f9-47df-49df-8f8c-a22a4fed3628" class="">Async functions are <a href="https://caniuse.com/#search=async%20await">supported</a>
 in most browsers and the Node.js runtime. They make it easier to write 
asynchronous code, but it is still critical to understand Promises well 
to use them with this new syntax.</p><p id="828fd2f9-ead4-4006-bab3-cf218ca0deb8" class="">
</p><p id="7c781b19-cf51-48f4-ba39-f9b5c4120aee" class="">The <code>async</code> and <code>await</code> syntax is attractive in
 its simplicity, but there are a lot of benefits that come with fully 
understanding how to accomplish the same things using Promises. We are 
focused on learning about testing and do not want the complexity of 
Promise chaining to make the process of learning testing harder.</p><p id="7adeb7d1-e0fd-48bb-b441-83c100855c3d" class="">
</p><h1 id="f40c5c82-1bac-4c51-bcee-8641af100966" class="">Test Plan Example</h1><p id="0a9dfb30-738d-4ec7-bc73-cd24a8f96d02" class="">
</p><p id="0bb475f9-56f9-47e7-8f87-05ae6ccba26b" class="">This is one way to start your test with suitable pseudo code.</p><p id="7db343e2-663f-4a5c-9f42-7ca26438734a" class="">
</p><h2 id="da15a724-5431-455b-985a-e49d2378ba74" class="">Test Plan:</h2><ul id="31b6fe79-7d2c-42e7-aacd-b3a76afddd91" class="bulleted-list"><li style="list-style-type:disc">The test will be called &quot;loads data, books an interview and reduces 
the spots remaining for the first day by 1&quot;, </li></ul><ul id="ece5eff6-3c73-4f2f-b85b-288d2874ab5a" class="bulleted-list"><li style="list-style-type:disc">and will be broken down into nine steps. <ul id="9a58f7f7-e4a2-4242-88c0-16535fffc04d" class="bulleted-list"><li style="list-style-type:circle">These steps don&#x27;t map directly to lines of code, but 
this test shouldn&#x27;t need more than 12-15 expressions.</li></ul></li></ul><p id="7f93b472-38cf-454a-94d8-29616a0a03c5" class="">
</p><ol type="1" id="56534e1e-e766-4b6d-b83c-7e23e292fc44" class="numbered-list" start="1"><li>Render the <code>Application</code>.</li></ol><ol type="1" id="44c0957e-56c3-4d25-8be4-ae1829ee110c" class="numbered-list" start="2"><li>Wait until the text &quot;Archie Cohen&quot; is displayed.</li></ol><ol type="1" id="1cc015c1-2c95-4502-a8c2-f787ca6fbf78" class="numbered-list" start="3"><li>Click the &quot;Add&quot; button on the first empty appointment.</li></ol><ol type="1" id="b72208b1-6f1a-4ced-a8d0-00d03fbd8024" class="numbered-list" start="4"><li>Enter the name &quot;Lydia Miller-Jones&quot; into the input with the placeholder &quot;Enter Student Name&quot;.</li></ol><ol type="1" id="6355168d-dc33-4525-b600-e22c75dde070" class="numbered-list" start="5"><li>Click the first interviewer in the list.</li></ol><ol type="1" id="6f1ff001-9f27-49c2-a3a1-421522d545a5" class="numbered-list" start="6"><li>Click the &quot;Save&quot; button on that same appointment.</li></ol><ol type="1" id="e7219e9e-4ec3-43d4-8690-cb411b484bd4" class="numbered-list" start="7"><li>Check that the element with the text &quot;Saving&quot; is displayed.</li></ol><ol type="1" id="14becc31-5fdd-4065-a917-8daf5419509c" class="numbered-list" start="8"><li>Wait until the element with the text &quot;Lydia Miller-Jones&quot; is displayed.</li></ol><ol type="1" id="08cd0c34-50a5-4a73-87b0-98648ecc56dc" class="numbered-list" start="9"><li>Check that the <code>DayListItem</code> with the text &quot;Monday&quot; also has the text &quot;no spots remaining&quot;.</li></ol><p id="94affaf5-80b8-4f42-8e59-1ce7f800764c" class="">
</p><p id="9858c193-a292-4977-93ed-99e0d96f92cf" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="0781621e-efac-453a-9de5-d6ac7854a385"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">Since we are not letting the component finish the API request, we might get a warning about <code>Warning: An update to Application inside a test was not wrapped in act(...).</code>
.
 We can fix this by making the test asynchronous and waiting for an 
element. Ignore the warning for now, we will make this test asynchronous
 in a few steps.</div></figure><p id="ea5e05d5-351a-42ea-a90d-9fef4a0c6e96" class="">
</p><p id="b1957601-039d-45c0-969f-f3ff552ac3c5" class="">
</p><p id="6b5ff8d5-1e6f-4e0c-a535-688c35e78eaa" class="">PrettyDOM</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="2f8d690a-0151-4f0d-82af-ea337cbae8b2"><div style="font-size:1.5em"><span class="icon">✅</span></div><div style="width:100%">Import the <code>prettyDOM</code>
 function from <code>@testing-library/react</code>
. Pass the <code>container</code>
 value to the <code>prettyDOM</code>
 function and <code>console.log</code>
 the returned text.</div></figure><p id="34db51a9-5390-472e-8e34-e5ec8d3cbb1d" class="">
</p><pre id="72346bec-6655-40e2-a2d6-b76638314fd1" class="code"><code>console.log(prettyDOM(container));</code></pre><ul id="37f55483-a005-4194-9590-469ab3e93366" class="bulleted-list"><li style="list-style-type:disc">shows the dom tree and gives valuable debug information.</li></ul><p id="26eb1128-8c8c-45a2-b7d9-0a679c1837fb" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="8ad0560e-6694-4288-b388-fa51786cca7e"><div style="font-size:1.5em"><span class="icon">✅</span></div><div style="width:100%">to show the DOM tree with the state loaded log in an async way</div></figure></div></article></body></html>